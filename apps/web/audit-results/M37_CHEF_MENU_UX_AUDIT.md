# M37 Chef Menu UX Audit Report

**Date:** 2026-01-21  
**Milestone:** M37 — Menu/Costing UX Verification + Prep Discovery  
**Scope:** Chef role's access to /inventory/recipes

---

## Executive Summary

The Chef role has **FULL** access to recipes via the API `/inventory/v2/recipes` endpoint. The recipes page at `/inventory/recipes` provides a complete BOM (Bill of Materials) builder interface.

### Key Findings

| Aspect | Status | Details |
|--------|--------|---------|
| Recipe API Access | ✅ Working | Chef token can GET `/inventory/v2/recipes` |
| Recipe Count (tapas) | ✅ 100 recipes | Full catalog |
| Recipe Count (cafesserie) | ✅ 80 recipes | Full catalog |
| Recipe Lines Valid | ✅ All | 9/9 (tapas), 15/15 (cafesserie) |

---

## 1. Endpoints Used

### Primary Endpoints

| Endpoint | Method | RBAC | Purpose |
|----------|--------|------|---------|
| `/inventory/v2/recipes` | GET | L3+ (Chef) | List all recipes |
| `/inventory/v2/recipes?includeLines=true` | GET | L3+ | List with ingredient lines |
| `/inventory/v2/recipes/:id` | GET | L3+ | Get recipe details |

### Secondary Endpoints

| Endpoint | Method | RBAC | Purpose |
|----------|--------|------|---------|
| `/inventory/items` | GET | L2+ | View ingredient stock levels |
| `/inventory/items/:id` | GET | L2+ | View individual item details |

---

## 2. Page Components

### `/inventory/recipes` Page

**File:** `apps/web/src/pages/inventory/recipes.tsx`

| Component | Purpose |
|-----------|---------|
| RecipesPage | Main page wrapper with AppShell |
| Search input | Filter recipes by name |
| Active filter | Toggle active/inactive recipes |
| Recipe list | Expandable rows showing recipe details |
| Recipe lines | Ingredient breakdown per recipe |
| Create/Edit dialog | CRUD for recipes (L4+ only) |

### Recipe Data Structure

```typescript
interface Recipe {
  id: string;
  name: string;
  targetType: 'MENU_ITEM' | 'INVENTORY_ITEM';
  targetId: string;
  outputQtyBase: string;
  isActive: boolean;
  lines: RecipeLine[];
}

interface RecipeLine {
  id: string;
  inventoryItemId: string;
  qtyInput: string;
  inputUomId: string;
  inventoryItem: { id, name, sku, unit };
}
```

---

## 3. Controls Available to Chef

| Control | Available | Notes |
|---------|-----------|-------|
| View recipes | ✅ Yes | Full list with search |
| View recipe lines | ✅ Yes | Expandable ingredient list |
| Create recipe | ⚠️ L4+ Only | Manager/Owner/Admin |
| Edit recipe | ⚠️ L4+ Only | Manager/Owner/Admin |
| Delete recipe | ⚠️ L4+ Only | Manager/Owner/Admin |
| Export recipes | ✅ Yes | CSV export |

---

## 4. Test Evidence

### From seed-invariants-v5.spec.ts

```
✅ INV-C1: Recipe v2 count > 0 [tapas] (100)
✅ INV-C1: Recipe v2 count > 0 [cafesserie] (80)
✅ INV-C2: Recipe lines reference valid inventory items [tapas] (9/9 valid)
✅ INV-C2: Recipe lines reference valid inventory items [cafesserie] (15/15 valid)
✅ INV-C6: Chef can access recipes page [tapas] (200)
✅ INV-C6: Chef can access recipes page [cafesserie] (200)
```

### From seed-invariants-v6.spec.ts

```
✅ INV-V6-1: Recipes visible to Chef > 0 [tapas] (100)
✅ INV-V6-1: Recipes visible to Chef > 0 [cafesserie] (80)
```

---

## 5. Gaps Identified

| Gap | Severity | Recommendation |
|-----|----------|----------------|
| Chef cannot create/edit recipes | Low | Intentional RBAC — no change needed |
| Recipe cost not displayed inline | Medium | Future: Add cost column to recipe list |
| No margin preview for Chef | Medium | Chef sees ingredients, not cost impact |

---

## 6. Files Analyzed

| File | Purpose |
|------|---------|
| [recipes.tsx](../../apps/web/src/pages/inventory/recipes.tsx) | Recipe/BOM builder page |
| [inventory-recipes.controller.ts](../../services/api/src/inventory/inventory-recipes.controller.ts) | V2 recipes API |
| [recipes.service.ts](../../services/api/src/inventory/recipes.service.ts) | Recipe business logic |

---

## Conclusion

**Chef menu UX is FUNCTIONAL.** The Chef role can view all recipes and their ingredient breakdowns. CRUD operations are correctly restricted to Manager/Owner/Admin (L4+). The data layer is fully populated with realistic recipes.

---

*Generated by M37 Menu/Costing UX Verification*
